<!doctype html>
<html lang="mn">
<head>
<meta charset="utf-8"/>
<meta name="viewport" content="width=device-width,initial-scale=1"/>

<title>üíå Love Letter</title>

<style>

:root{
  --pink:#ff4da6;
  --rose:#ff2d6f;
  --bg1:#050510;
  --bg2:#140a1a;
  --text:#f6f7ff;
  --radius:28px;
}

*{box-sizing:border-box}
html,body{height:100%}

body{
  margin:0;
  display:grid;
  place-items:center;
  overflow:hidden;
  font-family:system-ui;
  color:var(--text);

  background:
    radial-gradient(900px 700px at 15% 20%, rgba(255,77,166,.22), transparent 58%),
    radial-gradient(900px 700px at 85% 80%, rgba(139,92,246,.18), transparent 60%),
    linear-gradient(180deg,var(--bg1),var(--bg2));
}

/* overlay */
.overlay{
  position:fixed;
  inset:0;
  background:rgba(0,0,0,.85);
  backdrop-filter: blur(6px);
  opacity:0;
  pointer-events:none;
  transition:.4s;
}

.overlay.show{
  opacity:1;
  pointer-events:auto;
}

/* SOUND BUTTON */
.toolbar{
  position:fixed;
  top:15px;
  right:15px;
}

.tbtn{
  background:#0008;
  color:#fff;
  border:none;
  padding:10px 14px;
  border-radius:999px;
  cursor:pointer;
}

/* ENVELOPE */
.env{
  width:min(460px,92vw);
  aspect-ratio:16/10;
  position:relative;
  perspective:1800px;

  /* üö® DROP SHADOW FILTER –£–°–¢–ì–ê–°–ê–ù ‚Äî BLUR –ó–ê–°–ù–ê */
}

/* base */
.base{
  position:absolute;
  inset:0;
  border-radius:var(--radius);
  background:linear-gradient(145deg,#ffffff10,#ffffff03);
  border:1px solid #ffffff22;

  /* drop-shadow-–∏–π–≥ BOX SHADOW –±–æ–ª–≥–æ—Å–æ–Ω */
  box-shadow:0 30px 80px rgba(0,0,0,.7);
}

/* SIDE FLAPS */

.sideFlap{
  position:absolute;
  top:10%;
  bottom:10%;
  width:55%;
  background:#ffffff10;
}

.left{
  left:-6%;
  clip-path: polygon(0 50%,100% 0,100% 100%);
}

.right{
  right:-6%;
  clip-path: polygon(100% 50%,0 0,0 100%);
}

/* TOP FLAP */

.flap{
  position:absolute;
  left:0;
  right:0;
  top:0;
  height:55%;
  background:#ffffff15;

  clip-path:polygon(0 0,100% 0,50% 100%);

  transform-origin:top;
  transition:1s;
}

.open .flap{
  transform:rotateX(180deg);
}

/* SEAL */

.seal{
  position:absolute;
  left:50%;
  top:56%;
  transform:translate(-50%,-50%);
  width:80px;
  height:80px;
  border-radius:50%;
  border:none;
  font-size:30px;
  cursor:pointer;

  background:linear-gradient(90deg,var(--pink),var(--rose));
  box-shadow:0 0 30px #ff4da6;
}

/* LETTER */

.letter{
  position:absolute;
  left:8%;
  right:8%;
  bottom:10%;
  height:72%;

  background:#0f1424;
  border-radius:20px;
  padding:18px;

  opacity:0;
  transform:translateY(80%) scale(.6);
  transition:1s;
}

.letter.show{
  opacity:1;
}

.letter.pull{
  transform:translateY(-25%) scale(1.08);
}

/* BIG POPUP */

.letter.big{
  position:fixed;
  left:50%;
  top:50%;
  transform:translate(-50%,-50%);
  width:min(860px,94vw);
  height:min(84vh,760px);

  z-index:999;
  overflow:auto;

  background:
    repeating-linear-gradient(
      0deg,
      rgba(0,0,0,0) 0px,
      rgba(0,0,0,0) 3px,
      rgba(0,0,0,.04) 4px
    ),
    #0f1424;

  border:1px solid #ffffff22;
  box-shadow:0 90px 200px rgba(0,0,0,.85);

  /* TEXT SHARP –±–æ–ª–≥–æ—Ö */
  -webkit-font-smoothing:antialiased;
  text-rendering:geometricPrecision;
}

/* HEADER */

.header{
  background:#0005;
  padding:12px;
  border-radius:16px;
  margin-bottom:10px;
}

/* TEXT */

.type{
  white-space:pre-wrap;
  line-height:1.9;
  font-size:18px;
  max-width:70ch;
}

/* CLOSE */

.close{
  position:sticky;
  top:0;
  float:right;
  border:none;
  background:#0008;
  color:#fff;
  width:40px;
  height:40px;
  border-radius:50%;
  cursor:pointer;
}

</style>
</head>

<body>

<div class="toolbar">
  <button class="tbtn" id="soundBtn">üîä</button>
</div>

<div class="overlay" id="overlay"></div>

<div class="env" id="env">

  <div class="base"></div>

  <div class="sideFlap left"></div>
  <div class="sideFlap right"></div>

  <div class="flap"></div>

  <div class="letter" id="letter">

    <button class="close" id="close">‚úï</button>

    <div class="header">
      üíå –•–∞–π—Ä—Ç —á–∞–º–¥–∞–∞ ‚Äî –ù–∞–¥–∞–∞—Å
    </div>

    <div class="type" id="typeArea"></div>
  </div>

  <button class="seal" id="seal">üíó</button>

</div>

<script>

const seal = document.getElementById("seal");
const env = document.getElementById("env");
const letter = document.getElementById("letter");
const overlay = document.getElementById("overlay");
const closeBtn = document.getElementById("close");

let soundOn = true;

document.getElementById("soundBtn").onclick = () =>{
  soundOn = !soundOn;
  soundBtn.textContent = soundOn ? "üîä":"üîá";
};

/* SIMPLE SOUND */
function pop(){
  if(!soundOn) return;

  const ctx = new (window.AudioContext||window.webkitAudioContext)();
  const osc = ctx.createOscillator();
  const gain = ctx.createGain();

  osc.type="triangle";
  osc.frequency.value=500;

  gain.gain.value=.2;

  osc.connect(gain);
  gain.connect(ctx.destination);

  osc.start();
  osc.stop(ctx.currentTime+.1);
}

/* TEXT */

const text = `–ë–æ—Ä–∫–æ –º–∏–Ω—å ‚ù§Ô∏è

–ß–∞–º–¥ –±–∏—á–∏—Ö —ç–Ω—ç —Ö—ç–¥—Ö—ç–Ω –º”©—Ä –º–∏–Ω–∏–π –∑“Ø—Ä—Ö–Ω–∏–π —Ö–∞–º–≥–∏–π–Ω “Ø–Ω—ç–Ω “Ø–≥—Å —é–º.
–ß–∞–º–∞–π–≥ —É—á–∏—Ä—Å–∞–Ω —Ç—ç—Ä –º”©—á”©”©—Å —Ö–æ–π—à –º–∏–Ω–∏–π ”©–¥—Ä“Ø“Ø–¥ –∏–ª“Ø“Ø –≥—ç—Ä—ç–ª—Ç—ç–π, 
–∏–Ω—ç—ç–º—Å—ç–≥–ª—ç–ª –∏–ª“Ø“Ø –¥—É–ª–∞–∞—Ö–∞–Ω –±–æ–ª—Å–æ–Ω.
–ß–∏ –º–∏–Ω–∏–π –∞–º—å–¥—Ä–∞–ª–¥ –∑“Ø–≥—ç—ç—Ä –Ω—ç–≥ —Ö“Ø–Ω –±–∏—à ‚Äî —á–∏ –±–æ–ª —Ç–∞–π–≤—à—Ä–∞–ª, —É—Ä–∞–º –∑–æ—Ä–∏–≥, –∞–∑ –∂–∞—Ä–≥–∞–ª —é–º.

–•–∞–∂—É—É–¥ —á–∏–Ω—å –±–∞–π—Ö –±“Ø—Ä—Ç —Ü–∞–≥ —Ö—É–≥–∞—Ü–∞–∞ —É–¥–∞–∞—à–∏—Ä—á, –±“Ø—Ö –∑“Ø–π–ª –∑”©–≤ –≥–∞–∑—Ä–∞–∞ –±–∞–π–≥–∞–∞ –º—ç—Ç —Å–∞–Ω–∞–≥–¥–¥–∞–≥. 
–ß–∏–Ω–∏–π –∏–Ω—ç—ç–º—Å—ç–≥–ª—ç–ª –º–∏–Ω–∏–π —Ö–∞–º–≥–∏–π–Ω –¥—É—Ä—Ç–∞–π ‚Äú–∞—è‚Äù, —á–∏–Ω–∏–π –≥–∞—Ä –º–∏–Ω–∏–π —Ö–∞–º–≥–∏–π–Ω –∏—Ç–≥—ç–ª—Ç—ç–π ‚Äú–æ—Ä–æ–Ω –∑–∞–π‚Äù.

–ò—Ä—ç—ç–¥“Ø–π–¥ —é—É —Ç–æ—Ö–∏–æ–ª–¥–æ—Ö—ã–≥ –±–∏ –º—ç–¥—ç—Ö–≥“Ø–π —á –Ω—ç–≥ –∑“Ø–π–ª–∏–π–≥ –±–∞—Ç—Ç–∞–π –º—ç–¥–Ω—ç ‚Äî —Ç—ç—Ä –∏—Ä—ç—ç–¥“Ø–π–¥ —á–∞–º—Ç–∞–π–≥–∞–∞ —Ö–∞–º—Ç –∞–ª—Ö–º–∞–∞—Ä –±–∞–π–Ω–∞.
–ß–∞–º–∞–π–≥ –±–∞—è—Ä–ª—É—É–ª–∞—Ö —à–∞–ª—Ç–≥–∞–∞–Ω, —Ç“Ø—à–∏–≥–ª—ç—Ö –º”©—Ä, –±–∞—Ö–∞—Ä—Ö–∞—Ö —Ö“Ø–Ω —á–∏–Ω—å –±–∞–π—Ö—ã–Ω —Ç”©–ª”©”© –±–∏ “Ø—Ä–≥—ç–ª–∂ —Ö–∏—á—ç—ç–Ω—ç.
–•–∞–π—Ä—Ç–∞–π —à“Ø“Ø üíó`;

function typeWriter(t){
  let i=0;
  const area=document.getElementById("typeArea");
  area.textContent="";

  const inter=setInterval(()=>{
    area.textContent+=t[i];
    i++;
    if(i>=t.length) clearInterval(inter);
  },15);
}

/* OPEN */

seal.onclick=()=>{

  pop();

  env.classList.add("open");
  letter.classList.add("show");

  requestAnimationFrame(()=>{
    letter.classList.add("pull");
  });

  setTimeout(()=>{
    letter.classList.add("big");
    overlay.classList.add("show");

    typeWriter(text);

  },600);
};

/* CLOSE */

function closeLetter(){

  overlay.classList.remove("show");
  letter.classList.remove("big");
  letter.classList.remove("pull");

  setTimeout(()=>{
    letter.classList.remove("show");
    env.classList.remove("open");
    document.getElementById("typeArea").textContent="";
  },300);
}

closeBtn.onclick=closeLetter;
overlay.onclick=closeLetter;

window.onkeydown=(e)=>{
  if(e.key==="Escape") closeLetter();
};

</script>

</body>
</html>
